--- rpm-5.4.12/rpmio/rpmpython.c.rpmpythontrunc~	2013-08-09 03:04:11.101758151 +0200
+++ rpm-5.4.12/rpmio/rpmpython.c	2013-08-09 03:04:13.626789429 +0200
@@ -227,8 +227,18 @@ fprintf(stderr, "==> %s(%p,%s,%p)\n", __
 	    if (resultp != NULL) {
 		PyObject * sys_stdout = PySys_GetObject((char *)"stdout");
 		if (sys_stdout != NULL && PycStringIO_OutputCheck(sys_stdout)) {
+#if 0
+		    /* this would be more correct, but I'm unable to figure out what I'm doing wrong :| */
+		    char *tmp;
+		    int xx = (*PycStringIO->cread)(sys_stdout, &tmp, -1);
+		    *resultp = xx ? tmp : "";
+#else
+
 		    PyObject * o = (*PycStringIO->cgetvalue)(sys_stdout);
 		    *resultp = (PyString_Check(o) ? PyString_AsString(o) : "");
+		    PyObject_CallMethod(sys_stdout, "seek", "i",0);
+		    PyObject_CallMethod(sys_stdout, "truncate", NULL);
+#endif
 		} else
 		    *resultp = "";
 	    }
